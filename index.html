<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Test IA Open Source</title>
<style>
body { font-family:Arial,sans-serif; background:#f0f2f5; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
#chat-container { width:400px; border:2px solid #002D58; border-radius:10px; padding:15px; background:#fff; }
#msgs { height:200px; overflow-y:auto; border:1px solid #ccc; padding:10px; margin-bottom:10px; }
.user-msg { color:#002D58; font-weight:bold; margin:5px 0; }
.ai-msg { color:#333; margin:5px 0; }
input { width:calc(100% - 60px); padding:5px; }
button { width:50px; }
</style>
</head>
<body>

<div id="chat-container">
  <div id="msgs"></div>
  <input type="text" id="msg-input" placeholder="Votre question...">
  <button id="send-btn">âž¤</button>
</div>

<script>
const msgs = document.getElementById('msgs');
const input = document.getElementById('msg-input');
const btn = document.getElementById('send-btn');

function addMessage(text, type){
  const div = document.createElement('div');
  div.textContent = text;
  div.className = type==='user'?'user-msg':'ai-msg';
  msgs.appendChild(div);
  msgs.scrollTo({ top: msgs.scrollHeight, behavior:'smooth' });
}

async function sendMessage(){
  const val = input.value.trim();
  if(!val) return;
  input.value='';
  addMessage(val,'user');

  addMessage('ðŸ¤– Lâ€™IA rÃ©flÃ©chit...','ai');

  try{
    const res = await fetch('/api/chat', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ message: val })
    });
    const data = await res.json();
    // Supprime le loader
    msgs.querySelector('.ai-msg:last-child').remove();
    addMessage(data.text,'ai');
  }catch(err){
    msgs.querySelector('.ai-msg:last-child').remove();
    addMessage('Erreur de connexion.','ai');
  }
}

btn.onclick = sendMessage;
input.onkeydown = e => { if(e.key==='Enter'){ e.preventDefault(); sendMessage(); } };
</script>

</body>
</html>
